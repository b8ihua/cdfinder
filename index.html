<!DOCTYPE html>
<html lang="ja">
 <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CD計算ツール</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 2em 1em;
      background-color: #fff;
      max-width: 600px;
      margin: 0 auto;
    }

    h1 {
      font-size: 1.6em;
      text-align: left;
      margin-top:-0.2em;
      margin-bottom: 0.5em;
    }

    label {
      display: block;
      margin-bottom: 0.5em;
      font-size: 1.1em;
    }

    input {
      font-size: 2em;
      padding: 0.2em;
      width: 100%;
      box-sizing: border-box;
      
      text-transform: uppercase;
    }

    button {
      font-size: 1.2em;
      padding: 0.7em;
      width: 100%;
      background-color: #fafafa;
      color: #333;
      border: 1px solid #666;
      border-radius: 4px;
      cursor: pointer;
    }

    button:hover {
      background-color: #333;
     color: white;
    }

    #resultCd, #resultMessage {
      margin-top: 1em;
      font-size: 1.3em;
      color: #333;
      word-break: break-word;
    }

    #resultMessage.error {
      color: red;
    }

    .version-tag {
      display: inline-block;
      font-size: 0.65em;
      background-color: #f7f7f7;
      color: #666;
      padding: 2px 6px;
      border-radius: 4px;
      margin-bottom: 1em;
font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
    }

    .version {
      display: inline-block;
      font-size: 0.65em;
      background-color: #fff;
      color: #555;
      padding: 0em 0em;
      border-radius: 8px;
      margin-bottom: 1em;

    }

    /* 結果表示スタイル */
    .result-block {
font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
      
      margin-top: 1em;
      
      background-color: #fff;
      text-align: left;
      
      animation: fadeIn 0.6s ease-out forwards;
    }

    .result-code {
text-align:left;
background: linear-gradient(to right, #3B82F6, #6366F1, #9333EA, #EC4899); /* 青〜赤グラデ */
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      font-size: 2em;
      font-weight: bold;
      color: #222; 
      margin: 10px 0px 5px 0px;
    }

    .result-department {
      font-size: 1.2em;
      color: #555;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .gradient-text {
      font-size: 0.65em;
      font-weight: 600;
      font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif;
      background: linear-gradient(to right, #3B82F6, #6366F1, #9333EA, #EC4899, #F43F5E, #F97316); /* 青〜赤オレンジグラデ */
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

.result-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 0.7em;
  margin-top: 5px;
  color: #333;
  border: 1px solid #ddd;
  border-radius: 4px;
  overflow: hidden;
}

.result-table th,
.result-table td {
  padding: 0.5em 1em;
  border-bottom: 1px solid #ddd;
  background-color: #fff;
}

.result-table th {
  background-color: #eee;
  color: #555;
  font-weight: 600;
  width: 30%;
}

.result-table2 {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  font-size: 0.5em;
  margin-top: 5px;
  color: #333;
  border: 1px solid #ddd;
  border-radius: 4px;
  overflow: hidden;
}

.result-table2 th,
.result-table2 td {
  padding: 0.5em 1em;
  border-bottom: 1px solid #ddd;
  background-color: #fff;
}

.result-table2 th {
  background-color: #eee;
  color: #555;
  font-weight: 600;
  width: 15%;
}

/* 最後の行の下線を消して角丸下部を見せる */
.result-table tr:last-child th,
.result-table tr:last-child td {
  border-bottom: none;
}

.cp_iptxt {
  position: relative;
  width: 100%;
  margin: 20px 0;
}
.cp_iptxt input[type='text'] {

  font: 2em/1.6 sans-serif;
  width: 100%;
  padding-left: 0em;
  border: none;
  border-bottom: 1.5px solid #333;
  background: transparent;
}
.cp_iptxt .ef {
  padding: 4px 0;
  border: 0;
  border-bottom: 1.5px solid #1b2538;
  background-color: transparent;
}
.cp_iptxt .ef ~ .focus_line {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 0;
  height: 2px;
  transition: 0.4s;
  background: linear-gradient(to right, #3B82F6, #6366F1, #9333EA); /* 青〜赤グラデ */;
}
.cp_iptxt .ef ~ label {
  position: absolute;
  font-size: 12px;
  top: -14px;
  left: 0;
  width: 100%;
  color: #333;
  transition: 0.3s;
}
/*focus時の設定*/
.cp_iptxt input[type='text']:focus {
  outline: none;
}
.cp_iptxt .ef:focus ~ .focus_line {
  width: 100%;
  transition: 0.4s;
}
.cp_iptxt .ef:focus ~ label {
  font-size: 12px;
  top: -14px;
  transition: 0.3s;
  background: linear-gradient(to right, #3B82F6, #6366F1, #9333EA, #EC4899);
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;

}

  </style>
</head>
<body>
<span style="font-size:10px; font-weight: norma">学籍番号解析ツール</span>
  <h1>CDFinder</h1>

  <div class="version-tag"><b>ver</b>&nbsp; <span class="gradient-text">Universal Formula</span></div>
  <font class="version">Bから始まる全ての学部の学籍番号を解析可能</font>

 <div class="cp_iptxt">
  <input class="ef" id="codeInput" type="text" maxlength="8" placeholder="" style="border-radius:0px; color:#333; font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", sans-serif; ">
  <label>学籍番号を入力</label>
  <span class="focus_line"></span>
</div>


  <button onclick="runCalculation()">解&nbsp;析</button>

  <div id="resultCd"></div>
  <div id="resultMessage"></div>

  <script>

    function calculateCd(code) {
      if (code.length !== 8) {
        throw new Error("Error : 不適切な形式（E01）");
      }
      if (code[0].toLowerCase() !== 'b') {
        throw new Error("Error : 不適切な形式（E02）");
      }
      if (!(/^\d{3}$/.test(code.slice(1, 4)) && /^\d{3}$/.test(code.slice(5, 8)))) {
        throw new Error("Error : 不適切な形式（E03）");
      }
      if (!/[a-zA-Z]/.test(code[4])) {
        throw new Error("Error : 不適切な形式（E04）");
      }

      const table1 = { 's': 0, 't': 4, 'a': 4, 'n': 6, 'g': 6, 'r': 7, 'u': 8, 'b': 8, 'p': 10 };
      const table2 = {
        1: 'H', 2: 'T', 3: 'S', 4: 'N', 5: 'P', 6: 'R',
        7: 'X', 8: 'Y', 9: 'U', 10: 'M', 11: 'K'
      };

      const N6 = parseInt(code[1], 10);
      const N5 = parseInt(code[2], 10);
      const N4 = parseInt(code[3], 10);
      const X = code[4].toLowerCase();
      const N3 = parseInt(code[5], 10);
      const N2 = parseInt(code[6], 10);
      const N1 = parseInt(code[7], 10);

      if (!(X in table1)) {
        throw new Error(`Error : 不適切な英字: ${X}（E05）`);
      }

      const xnum = table1[X];
      const total = (N1 * 1 + N2 * 2 + N3 * 3 + xnum * 1 + N4 * 6 + N5 * 7 + N6 * 8);
      const ref_val = Math.abs((total % 11) - 11);
      const cd = table2[ref_val];

      return cd;
    }

    function getDepartment(n4, x) {
      const key = `${n4}${x}`;
      const departmentMap = {
        '1g': '人文社会学部人文社会学科',
        '2g': '教育学部学校教育教員養成課程',
        '3p': '理工学部数学物理学科',
        '3r': '理工学部情報科学科',
        '3s': '理工学部生物化学科',
        '3t': '理工学部化学生命理工学科',
        '3u': '理工学部地球環境防災学科',
        '4n': '農林海洋科学部農林資源環境科学科',
        '4p': '農林海洋科学部農芸化学科',
        '4r': '農林海洋科学部海洋資源科学科',
        '4s': '農林海洋科学部農林資源科学科',
        '4t': '農林海洋科学部海洋資源科学科',
        '5a': '医学部医学科',
        '5b': '医学部看護学科',
        '6a': '地域協働学部地域協働学科'
      };
      return departmentMap[key.toLowerCase()] || '（不明な学科）';
    }

    function runCalculation() {
      const input = document.getElementById('codeInput').value.trim();
      const resultCd = document.getElementById('resultCd');
      const resultMessage = document.getElementById('resultMessage');

      resultCd.innerHTML = '';
      resultMessage.textContent = '';
      resultMessage.className = '';

      try {
        const cd = calculateCd(input);
        const fullCode = input.toUpperCase() + cd;
        const N6 = input[1];
    const N5 = input[2];
    const N4 = input[3];
    const X = input[4];
    const N3 = input[5];
    const N2 = input[6];
    const N1 = input[7];

        const department = getDepartment(N4, X);

        const course = (N4 === '1') ? (
  ['0', '1'].includes(N3) ? '人文科学コース' :
  ['2', '3'].includes(N3) ? '国際社会コース' :
  ['4', '5'].includes(N3) ? '社会科学コース' : '-'
) : '-';

const campus = (N4 === '5') ? '岡豊・病院' :
               (N4 === '4') ? '物部' : '朝倉';

const year = `20${N6}${N5}年度`;

const attendanceNo = `${N3}${N2}${N1}`;

resultCd.innerHTML = `
  <div class="result-block fade-in">
    <div style="text-align:left; font-size:17px; margin-bottom:10px;"><span class="material-icons-outlined" style="font-size:27px ;position: relative; top: 6px">
auto_awesome
</span> 解析結果</div>
    <div class="result-code">${fullCode}</div>
<span style="font-size: 15px;">学籍番号から得られる学籍情報</span>
    <table class="result-table">
      <tr>
        <th>学部学科</th>
        <td>${department}</td>
      </tr>
      <tr>
        <th>コース</th>
        <td>${course}</td>
      </tr>
      <tr>
        <th>校地</th>
        <td>${campus}</td>
      </tr>
      <tr>
        <th>入学年</th>
        <td>${year}</td>
      </tr>
      <tr>
        <th>出席番号</th>
        <td>${attendanceNo}</td>
      </tr>
    </table>
  </div>
<p style="line-height:150%; font-size: 14px; color: #aaa; ">※ この結果は本講座のアルゴリズムにより演算されたものであり、特定の個人情報やデータベースを元に算出したものではありません。</p>
`;
        resultMessage.textContent = "";
        resultMessage.classList.add("success");
      } catch (e) {
  resultCd.innerHTML = `
     <div class="result-block fade-in">
    <div style="text-align:left; font-size:17px; margin-bottom:10px; "><span class="material-icons-outlined" style="color: #EC4899; font-size:27px ;position: relative; top: 6px">
error_outline
</span> <span style="color:#EC4899">解析できませんでした</span></div>  <span style="font-size:17px; color:#EC4899">${e.message}</span>
    <table class="result-table2">
      <tr>
        <th>E01</th>
        <td>学籍番号は8桁で入力する必要があります。</td>
      </tr>
      <tr>
        <th>E02</th>
        <td>現verではBから始まる学籍番号しか解析できません。</td>
      </tr>
      <tr>
        <th>E03</th>
        <td>2,3,4,6,7,8桁目は数字である必要があります。</td>
      </tr>
      <tr>
        <th>E04</th>
        <td>5桁目は英字である必要があります。</td>
      </tr>
      <tr>
        <th>E05</th>
        <td>不適切な英字が入力されました。</td>
      </tr>
    </table>
  </div>
`;
  resultMessage.textContent = "";
  resultMessage.className = "";
}
    }
  </script>





</body>
</html>
